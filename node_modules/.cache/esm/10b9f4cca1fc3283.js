let readline,spielerArr,questionsHtml,questionsCss,questionsJavascript;_a1f‍.x([["chooseCategory",()=>chooseCategory],["shuffleArray",()=>shuffleArray],["createPlayer",()=>createPlayer],["showResults",()=>showResults]]);_a1f‍.w("readline-sync",[["default",["readline"],function(v){readline=v}]]);_a1f‍.w("./main",[["spielerArr",["spielerArr"],function(v){spielerArr=v}]]);_a1f‍.w("./questionList",[["questionsHtml",["questionsHtml"],function(v){questionsHtml=v}],["questionsCss",["questionsCss"],function(v){questionsCss=v}],["questionsJavascript",["questionsJavascript"],function(v){questionsJavascript=v}]]);







const GREEN = "\u001B[1m\u001B[32m",
  RED = "\u001B[1m\u001B[31m",
  YELLOW = "\u001B[1m\u001B[33m",
  ANSI = "\u001B[39m\u001B[22m";

       function chooseCategory() {
  const categoryNum = _a1f‍.a("readline",readline).questionInt(
    `${GREEN}
Choose a quiz topic: ${ANSI} 
${YELLOW}
 1. HTML
 2. CSS
 3. JavaScript
${ANSI}
You choose a category: `
  );
  console.clear();

  let res;

  switch (categoryNum) {
    case 1:
      res = makeQuestion(_a1f‍.a("questionsHtml",questionsHtml));
      break;
    case 2:
      res = makeQuestion(_a1f‍.a("questionsCss",questionsCss));
      break;
    case 3:
      res = makeQuestion(_a1f‍.a("questionsJavascript",questionsJavascript));
      break;
    default:
      console.log("Wrong category number! Try again!");
      chooseCategory();
  }
  return res;
}

function makeQuestion(category) {
  let wasQuestion = []; // array for questions that already were
  let result = 0;
  let num = 1;

  while (wasQuestion.length < category.length) {
    let index = Math.floor(Math.random() * category.length); // next question index
    const { question, choices, correctAnswer } = category[index];

    if (!wasQuestion.includes(index)) {
      console.log(`\n${YELLOW}${num}. ${question}${ANSI}`);
      const shuffleArr = shuffleArray(choices); // shuffle answers
      shuffleArr.forEach((item, number) => {
        _a1f‍.g.console.log(number + 1 + ".", item);
      });

      const userInput = _a1f‍.a("readline",readline).question(
        `${YELLOW}Enter your answer (1-${shuffleArr.length}): ${ANSI}`
      );
      const userChoiceIndex = parseInt(userInput) - 1;
      const userChoice = shuffleArr[userChoiceIndex];

      if (userChoice === correctAnswer) {
        result++;
        console.log(`${GREEN}Correct answer!${ANSI}`);
      } else {
        console.log(
          `${RED}Wrong answer!${ANSI}\nThe correct answer is: ${GREEN}${correctAnswer}${ANSI}`
        );
      }

      num++;
      wasQuestion.push(index);
    }
  }

  console.log(
    `\n${YELLOW}The round is complete!. Your result: ${result}/${category.length}${ANSI}`
  );
  return result;
}

       function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

       function createPlayer(name) {
  let players = {};
  players = { name, punktzahl: 0 };
  return players;
}

       function showResults() {
  console.log(`\n${GREEN}The quiz is complete. Player results:${ANSI}`);
  let max = 0;
  let winner;
  _a1f‍.a("spielerArr",spielerArr).forEach((player) => {
    console.log(`${player.name}: ${YELLOW}${player.punktzahl}${ANSI}`);
    if (player.punktzahl > max) {
      max = player.punktzahl;
      winner = player.name;
    }
  });

  console.log(`\n${GREEN}Winner: ${winner.toUpperCase()}${ANSI}`);
  console.log(`\n${GREEN}Thanks for playing!\n${ANSI}`);
}
